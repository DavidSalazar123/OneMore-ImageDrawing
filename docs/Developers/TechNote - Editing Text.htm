<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name='description' content='OneMore is an add-in for OneNote with simple and powerful features that make OneNote a better OneNote'>
  <title>OneMore - a OneNote add-in</title>
  <link href="/nav.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <link href="/toc.css" rel="stylesheet" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
  <script src="/helpers.js"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      $('#nav-container').load('/nav.htm', function() { HighlightActive('developers'); });
      $('#toc-container').load('toc.htm', function() { HighlightActive('technote---editing-text'); });
    });
  </script>
</head>

<body>
  <div id="nav-container" class="sticky-top"></div>
  <div id="toc-container" class="sidenav"></div>
  <div class="main">
    <div class="container-xxl bd-gutter mt-3 my-md-4 bd-layout tab-content" id="content">
      <div class="container-xxl bd-gutter mt-3 my-md-4 bd-layout">
        <div id="main-content">
          <DIV style="DIRECTION: ltr">
<DIV style="WIDTH: 8.972in; MARGIN-TOP: 0in; DIRECTION: ltr; MARGIN-LEFT: 0in">
<DIV style="WIDTH: 3.14in; MARGIN-TOP: 0in; DIRECTION: ltr; MARGIN-LEFT: 0.075in">
<P lang=yo style='FONT-SIZE: 20pt; FONT-FAMILY: "Calibri Light"; MARGIN: 0in'>TechNote - Editing Text</P></DIV>
<DIV style="WIDTH: 2.287in; MARGIN-TOP: 0.042in; DIRECTION: ltr; MARGIN-LEFT: 0.075in">
<P style="FONT-SIZE: 10pt; FONT-FAMILY: Calibri; COLOR: #767676; MARGIN: 0in">Friday, March 10, 2023</P>
<P style="FONT-SIZE: 10pt; FONT-FAMILY: Calibri; COLOR: #767676; MARGIN: 0in">10:29 AM</P></DIV>
<DIV style="WIDTH: 8.972in; MARGIN-TOP: 0.427in; DIRECTION: ltr; MARGIN-LEFT: 0in">
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">As described by the <A href="https://github.com/stevencohn/OneMore/blob/main/Reference/0336.OneNoteApplication_2013.xsd">OneNote XML Schema definition</A>, the simplest representation of a line of text in OneNote can be expressed as:</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: #2e75b5">&lt;</SPAN><SPAN style="COLOR: firebrick">one</SPAN><SPAN style="COLOR: #2e75b5">:</SPAN><SPAN style="COLOR: firebrick">OE </SPAN><SPAN style="COLOR: #f1937a">alignment</SPAN><SPAN style="COLOR: #2e75b5">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: #2e75b5">left</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: #f1937a">quickStyleIndex</SPAN><SPAN style="COLOR: #2e75b5">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: #2e75b5">1</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: #2e75b5">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: black"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN></SPAN><SPAN style="COLOR: #2e75b5">&lt;</SPAN><SPAN style="COLOR: firebrick">one</SPAN><SPAN style="COLOR: #2e75b5">:</SPAN><SPAN style="COLOR: firebrick">T</SPAN><SPAN style="COLOR: #2e75b5">&gt;</SPAN>&lt;![CDATA[<SPAN style="COLOR: gray">Hello World</SPAN><SPAN style="COLOR: #2e75b5">]]&gt;</SPAN>&lt;/<SPAN style="COLOR: firebrick">one</SPAN>:<SPAN style="COLOR: firebrick">T</SPAN>&gt;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'>&lt;/<SPAN style="COLOR: firebrick">one</SPAN>:<SPAN style="COLOR: firebrick">OE</SPAN>&gt;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">Every paragraph of text is expressed as a OneNote Element, or </SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: blue'>&lt;</SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: #a31515'>one</SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: blue'>:</SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: #a31515'>OE</SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: blue'>&gt;</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">. An element is comprised of one or more text runs, </SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: blue'>&lt;</SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: #a31515'>one</SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: blue'>:</SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: #a31515'>T</SPAN><SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: blue'>&gt;</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">. And a text run includes a CDATA.</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<H1 lang=yo style="FONT-SIZE: 16pt; FONT-FAMILY: Calibri; COLOR: #1e4e79; MARGIN: 0in">Selected Text</H1>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">Selected text is identified by looking for the </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>selected</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> attribute. In this example, the entire paragraph is selected, so there is a </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>selected="all"</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> attribute on the text run.</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue">&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">OE </SPAN><SPAN style="COLOR: red">alignment</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">left</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: red">quickStyleIndex</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">1</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: red">selected</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">=</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">partial</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="COLOR: blue">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: black"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN></SPAN><SPAN style="COLOR: blue">&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T </SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: red">selected</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">=</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">all</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="COLOR: blue">&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="COLOR: gray">Hello World</SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">OE</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">Note that all ancestors of the selection will include the attribute </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>selected="partial"</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">. This includes the immediate </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>one:OE</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> and the entire hierarchy back up to and including the containing </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>one:Outline</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">.</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<H1 lang=yo style="FONT-SIZE: 16pt; FONT-FAMILY: Calibri; COLOR: #1e4e79; MARGIN: 0in">Complex Selections</H1>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">When only part of a paragraph is selected, OneNote divides the paragraph into multiple text runs so it can apply the </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>selected</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> attribute to only the selected run, as shown here</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue">&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">OE </SPAN><SPAN style="COLOR: red">alignment</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">left</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: red">quickStyleIndex</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">4</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: red">selected</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">=</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">partial</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="COLOR: blue">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: black"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN></SPAN><SPAN style="COLOR: blue">&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T </SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: red">selected</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">=</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">all</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="COLOR: blue">&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="COLOR: gray">Hello </SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: black"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN></SPAN><SPAN style="COLOR: blue">&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: blue">&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="COLOR: gray">World</SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">OE</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<DIV style="DIRECTION: ltr">
<TABLE title="" style="BORDER-TOP: #a3a3a3 1pt solid; BORDER-RIGHT: #a3a3a3 1pt solid; BORDER-COLLAPSE: collapse; BORDER-BOTTOM: #a3a3a3 1pt solid; DIRECTION: ltr; BORDER-LEFT: #a3a3a3 1pt solid" cellSpacing=0 cellPadding=0 summary="" border=1 valign="top">
<TBODY>
<TR>
<TD style="BORDER-TOP: #a3a3a3 1pt solid; BORDER-RIGHT: #a3a3a3 1pt solid; WIDTH: 8.534in; VERTICAL-ALIGN: top; BORDER-BOTTOM: #a3a3a3 1pt solid; PADDING-BOTTOM: 2pt; PADDING-TOP: 2pt; PADDING-LEFT: 3pt; BORDER-LEFT: #a3a3a3 1pt solid; PADDING-RIGHT: 3pt; BACKGROUND-COLOR: #e5e0ec">
<DIV style="DIRECTION: ltr">
<TABLE title="" style="BORDER-TOP: #a3a3a3 0pt solid; BORDER-RIGHT: #a3a3a3 0pt solid; BORDER-COLLAPSE: collapse; BORDER-BOTTOM: #a3a3a3 0pt solid; DIRECTION: ltr; BORDER-LEFT: #a3a3a3 0pt solid" cellSpacing=0 cellPadding=0 summary="" border=0 valign="top">
<TBODY>
<TR>
<TD style="BORDER-LEFT-WIDTH: 0pt; BORDER-RIGHT-WIDTH: 0pt; WIDTH: 0.681in; VERTICAL-ALIGN: top; BORDER-BOTTOM-WIDTH: 0pt; PADDING-BOTTOM: 2pt; PADDING-TOP: 2pt; PADDING-LEFT: 3pt; PADDING-RIGHT: 3pt; BORDER-TOP-WIDTH: 0pt">
<P style='FONT-SIZE: 22pt; FONT-FAMILY: "Segoe UI Emoji"; TEXT-ALIGN: center; MARGIN: 0in'>📓</P></TD>
<TD style="BORDER-LEFT-WIDTH: 0pt; BORDER-RIGHT-WIDTH: 0pt; WIDTH: 7.709in; VERTICAL-ALIGN: top; BORDER-BOTTOM-WIDTH: 0pt; PADDING-BOTTOM: 2pt; PADDING-TOP: 2pt; PADDING-LEFT: 3pt; PADDING-RIGHT: 3pt; BORDER-TOP-WIDTH: 0pt">
<P lang=yo style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #333333; MARGIN: 0in'><SPAN style="FONT-WEIGHT: bold">There can only be one!</SPAN></P>
<P lang=yo style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #333333; MARGIN: 0in'>Within a single paragraph, there can only one contiguous selection. It can span multiple text runs but it can't skip text runs. This means that you can select text from the middle of a paragraph like</P>
<P lang=yo style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #333333; MARGIN: 0in'>&nbsp;</P>
<P lang=yo style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #44546a; MARGIN: 0in 0in 0in 0.375in'>This is an example paragraph with a <SPAN style="BACKGROUND: silver; mso-highlight: silver">text selection</SPAN> in the midle of it.</P>
<P lang=yo style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #333333; MARGIN: 0in'>&nbsp;</P>
<P lang=yo style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #333333; MARGIN: 0in'>But even using the OneMore <SPAN style="FONT-STYLE: italic">Invert Selection</SPAN> command, you cannot create a selection like this:</P>
<P lang=yo style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #333333; MARGIN: 0in'>&nbsp;</P>
<P lang=yo style="MARGIN: 0in 0in 0in 0.375in"><SPAN style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; BACKGROUND: silver; COLOR: #44546a; mso-highlight: silver'>This is an example paragraph with</SPAN><SPAN style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #44546a'> a text selection </SPAN><SPAN style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; BACKGROUND: silver; COLOR: #44546a; mso-highlight: silver'>in the midle of it</SPAN><SPAN style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #333333'>. </SPAN><SPAN style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #e84c22'><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;</SPAN></SPAN><SPAN style='FONT-SIZE: 12pt; FONT-FAMILY: "Segoe UI Emoji"; COLOR: #fa0000'>← </SPAN><SPAN style='FONT-SIZE: 11pt; FONT-FAMILY: "Segoe UI"; COLOR: #fa0000; FONT-STYLE: italic'>Not possible!</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></DIV>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<H1 lang=yo style="FONT-SIZE: 16pt; FONT-FAMILY: Calibri; COLOR: #1e4e79; MARGIN: 0in">Empty Selection</H1>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">There are a couple of exceptions to note. The first is the <SPAN style="FONT-STYLE: italic">empty selection</SPAN> which indicates the current position of the text cursor, if the cursor is focused on the page.</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in'><SPAN style="COLOR: blue">&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">OE </SPAN><SPAN style="COLOR: red">alignment</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">left</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: red">quickStyleIndex</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">4</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: red">selected</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">partial</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN>&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: blue">&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="COLOR: gray">Hel</SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN></SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">&lt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">one</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">:</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">T </SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: red">selected</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">=</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">all</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">&gt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">]]&gt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #172b4d">&lt;/</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">one</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #172b4d">:</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">T</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN>&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: blue">&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="COLOR: gray">lo World</SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in'><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">OE</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">The paragraph is divided into multiple text runs, where the middle text run includes an empty CDATA[] indicating the cursor position. So when detecting selected runs, routines need to consider whether there is exactly on select run and whether its content is an empty string.</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<H1 lang=yo style="FONT-SIZE: 16pt; FONT-FAMILY: Calibri; COLOR: #1e4e79; MARGIN: 0in">URLs and MathML</H1>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">Another exception is when the text cursor is position within hyperlinked text or over a MathML equation. For example, given the following paragraph where we presume the text cursor is placed immediately after the word "Page":</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in 0in 0in 0.375in">The <A href="https://github.com/stevencohn/OneMore/blob/main/OneMore/Models/Page.cs">Page| class</A> contains…</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">The XML looks like this (the URL is truncated for simplicity)</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue">&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">OE </SPAN><SPAN style="COLOR: red">alignment</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">left</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: red">quickStyleIndex</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">3</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: red">selected</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">partial</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN>&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: blue">&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="COLOR: gray">The </SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN></SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">&lt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">one</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">:</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">T </SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: red">selected</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">=</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">all</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">&gt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: gray">&lt;a href="https://..."&gt;Page class&lt;/a&gt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">]]&gt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #172b4d">&lt;/</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">one</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #172b4d">:</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">T</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN>&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: blue">&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;![CDATA[</SPAN><SPAN style="COLOR: gray"> contains...</SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: #172b4d">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: #172b4d">:</SPAN><SPAN style="COLOR: #a31515">OE</SPAN><SPAN style="COLOR: #172b4d">&gt;</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">Notice that the entire URL CDATA is wrapped in a text run decorated with </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>selected="all"</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> even though the selection range is actually of zero length. The OneMore Page class detects this case and sets the SelectionScope to Empty even though the full CDATA will be returned as the selected text.</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">Compare that to actually selecting the full URL:</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in 0in 0in 0.375in">The <A href="https://github.com/stevencohn/OneMore/blob/main/OneMore/Models/Page.cs"><SPAN style="BACKGROUND: #e5e0ec">Page class</SPAN></A> contains…</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">The XML looks exactly the same as it does above!</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue">&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">OE </SPAN><SPAN style="COLOR: red">alignment</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">left</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: red">quickStyleIndex</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">3</SPAN><SPAN style="COLOR: black">" </SPAN><SPAN style="COLOR: red">selected</SPAN><SPAN style="COLOR: blue">=</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">partial</SPAN><SPAN style="COLOR: black">"</SPAN><SPAN style="COLOR: blue">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN>&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: blue">&gt;</SPAN>&lt;![CDATA[<SPAN style="COLOR: gray">The </SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN>&lt;/<SPAN style="COLOR: #a31515">one</SPAN>:<SPAN style="COLOR: #a31515">T</SPAN>&gt;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN></SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">&lt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">one</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">:</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">T </SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: red">selected</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">=</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">all</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: black">"</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">&gt;</SPAN><SPAN style="BACKGROUND: #ffff99">&lt;![CDATA[</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: gray">&lt;a href="https://..."&gt;Page class&lt;/a&gt;</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: blue">]]&gt;</SPAN><SPAN style="BACKGROUND: #ffff99">&lt;/</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">one</SPAN><SPAN style="BACKGROUND: #ffff99">:</SPAN><SPAN style="BACKGROUND: #ffff99; COLOR: #a31515">T</SPAN><SPAN style="BACKGROUND: #ffff99">&gt;</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: blue"><SPAN style="mso-spacerun: yes">&nbsp; </SPAN>&lt;</SPAN><SPAN style="COLOR: #a31515">one</SPAN><SPAN style="COLOR: blue">:</SPAN><SPAN style="COLOR: #a31515">T</SPAN><SPAN style="COLOR: blue">&gt;</SPAN>&lt;![CDATA[<SPAN style="COLOR: gray"> contains...</SPAN><SPAN style="COLOR: blue">]]&gt;</SPAN>&lt;/<SPAN style="COLOR: #a31515">one</SPAN>:<SPAN style="COLOR: #a31515">T</SPAN>&gt;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: black">&lt;/</SPAN><SPAN style="COLOR: #a31515">one</SPAN>:<SPAN style="COLOR: #a31515">OE</SPAN>&gt;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">OneNote doesn't project these two cases differently in the XML. So OneNote needs to treat them the same.</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<H1 lang=yo style="FONT-SIZE: 16pt; FONT-FAMILY: Calibri; COLOR: #1e4e79; MARGIN: 0in">How OneMore Edits Text</H1>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">OneMore has many internal routines to parse complex structures in the page XML. The <A href="https://github.com/stevencohn/OneMore/blob/main/OneMore/Models/Page.cs">Page class</A> contains most of these routines including:</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<DIV style="DIRECTION: ltr">
<TABLE title="" style="BORDER-TOP: #a3a3a3 0pt solid; BORDER-RIGHT: #a3a3a3 0pt solid; BORDER-COLLAPSE: collapse; BORDER-BOTTOM: #a3a3a3 0pt solid; DIRECTION: ltr; MARGIN-LEFT: 0.333in; BORDER-LEFT: #a3a3a3 0pt solid" cellSpacing=0 cellPadding=0 summary="" border=0 valign="top">
<TBODY>
<TR>
<TD style="BORDER-LEFT-WIDTH: 0pt; BORDER-RIGHT-WIDTH: 0pt; WIDTH: 4.618in; VERTICAL-ALIGN: top; BORDER-BOTTOM-WIDTH: 0pt; PADDING-BOTTOM: 2pt; PADDING-TOP: 2pt; PADDING-LEFT: 3pt; PADDING-RIGHT: 3pt; BORDER-TOP-WIDTH: 0pt">
<P style="MARGIN: 0in"><IMG src="TechNote%20-%20Editing%20Text_files/image001.png" width=425 height=196></P></TD>
<TD style="BORDER-LEFT-WIDTH: 0pt; BORDER-RIGHT-WIDTH: 0pt; WIDTH: 0.5in; VERTICAL-ALIGN: top; BORDER-BOTTOM-WIDTH: 0pt; PADDING-BOTTOM: 2pt; PADDING-TOP: 2pt; PADDING-LEFT: 3pt; PADDING-RIGHT: 3pt; BORDER-TOP-WIDTH: 0pt">
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P></TD></TR></TBODY></TABLE></DIV>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">The routines most commonly used by OneMore commands are </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>GetSelectedText</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> and </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>GetSelectectedElements</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">.</SPAN></P>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"><BR>The most complex routine, as you may guess, is </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>EditSelected</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">. The two overrides of this routine invoke an edit function on the selected text. The selection may be either infered from the current cursor position or explicitly highlighted as a selected region. No assumptions are made as to the resultant content or the order in which parts of context are edited.</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">The callback Func accepts an XNode and returns an XNode. This is either an XText or a "span" XElement. The returned XNode can be either the original unmodified, the original modified, or a new XNode. Regardless, the returned XNode will replace the current XNode in the content.</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">The </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>EditSelected</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> routines take it one step further to emulate functionality similar to the way Microsoft Word lets you modify text. If the cursor is placed on a word, and that word is expressed as multiple text runs due to varying styling, EditSelected will apply the Func to the entire word. If there is a selection range greater than zero then the routine will apply the Func to the entire selection even if that means splitting treatments in the middle of a word.</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">The </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>SelectionScope</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> property gets the most recently known selection state where </SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; FONT-STYLE: italic">none</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> means unknown, </SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; FONT-STYLE: italic">all</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> means there is an obvious selection region, and </SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; FONT-STYLE: italic">partial</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> means the selection region is zero.</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="MARGIN: 0in"><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri">The </SPAN><SPAN style='FONT-SIZE: 9.5pt; FONT-FAMILY: "Lucida Console"; BACKGROUND: #e8e8e8; COLOR: #172b4d'>SelectionSpecial</SPAN><SPAN style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri"> property gets an indication that the text cursor is positioned over either a hyperlink or a MathML equation, both of which return zero-length selection ranges.</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Courier New"; COLOR: #43577c; MARGIN: 0in'>────────────────────────────────────────────────────────────────────────────────────────────────────</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in"><SPAN style="FONT-STYLE: italic">Page PlantUML (</SPAN><A href="onemore://PlantUmlCommand/d673f0746bcd4d849788b1ebbddb6a41"><SPAN style="FONT-STYLE: italic">Refresh</SPAN></A><SPAN style="FONT-STYLE: italic">)</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="FONT-WEIGHT: bold; COLOR: #5b9bd5">@startuml</SPAN><SPAN style="COLOR: black"> Page</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: #a5a5a5">skinparam</SPAN><SPAN style="COLOR: black"> defaultFontSize </SPAN><SPAN style="COLOR: #8064a2">9</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: lightseagreen">class</SPAN><SPAN style="COLOR: black"> Page {</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: black; MARGIN: 0in 0in 0in 0.375in'><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>+get_SelectionScope: SelectionScope</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: black; MARGIN: 0in 0in 0in 0.375in'><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>+get_SelectionSpecial: bool</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: black; MARGIN: 0in 0in 0in 0.375in'><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>+bool EditNode(XElement cursor, Func edit)</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: black; MARGIN: 0in 0in 0in 0.375in'><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>+bool EditSelected(Func edit)</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: black; MARGIN: 0in 0in 0in 0.375in'><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>+bool EditSelected(XElement root, Func edit)</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: black; MARGIN: 0in 0in 0in 0.375in'><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>+XElement ExtractSelectedContent(out XElement firstParent)</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; MARGIN: 0in 0in 0in 0.375in'><SPAN style="COLOR: black"><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>+IEnumerable GetSelectedElements(bool all = </SPAN><SPAN style="COLOR: #2e75b5">true</SPAN><SPAN style="COLOR: black">)</SPAN></P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: black; MARGIN: 0in 0in 0in 0.375in'><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>+string GetSelectedText()</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: black; MARGIN: 0in 0in 0in 0.375in'>}</P>
<P lang=yo style='FONT-SIZE: 10pt; FONT-FAMILY: "Lucida Console"; COLOR: #5b9bd5; MARGIN: 0in 0in 0in 0.375in'><SPAN style="FONT-WEIGHT: bold">@enduml</SPAN></P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P lang=yo style="FONT-SIZE: 11.5pt; FONT-FAMILY: Calibri; MARGIN: 0in">&nbsp;</P>
<P><CITE lang=yo style="FONT-SIZE: 10pt; FONT-FAMILY: Calibri; COLOR: #595959; MARGIN: 0in">© 2020 Steven M Cohn. All rights reserved.</CITE></P>
<P><CITE lang=yo style="FONT-SIZE: 10pt; FONT-FAMILY: Calibri; COLOR: #595959; MARGIN: 0in">Please consider a <A href="https://github.com/sponsors/stevencohn">sponsorship or one-time donation</A> to support ongoing development</CITE></P></DIV></DIV></DIV>
<DIV>
<P style="MARGIN: 0in">&nbsp;</P>
<P style="FONT-SIZE: 9pt; FONT-FAMILY: Arial; COLOR: #969696; DIRECTION: ltr; TEXT-ALIGN: left; MARGIN: 0in">Created with OneNote.</P></DIV>
        </div>
      </div>
    </div>
  </div>
</body>

</html>

